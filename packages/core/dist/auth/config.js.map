{
  "version": 3,
  "sources": ["..\\src\\auth\\config.ts", "..\\src\\database\\schema\\auth.schema.ts"],
  "sourcesContent": [
    "import { drizzleAdapter } from \"better-auth/adapters/drizzle\";\r\nimport { betterAuth } from \"better-auth\";\r\n\r\nimport { type Database } from \"../database\";\r\nimport * as authSchema from \"../database/schema/auth.schema\";\r\nimport { admin, openAPI } from \"better-auth/plugins\";\r\n\r\nexport interface AuthConfigurations {\r\n  database: Database;\r\n  secret?: string;\r\n  plugins?: Parameters<typeof betterAuth>[0][\"plugins\"];\r\n}\r\n\r\nexport function configAuth(config: AuthConfigurations) {\r\n  const isProduction =\r\n    process.env.VERCEL_ENV === \"production\" ||\r\n    process.env.NODE_ENV === \"production\";\r\n\r\n  const baseAuthInstance = betterAuth({\r\n    baseURL: process.env.BETTER_AUTH_URL,\r\n    trustedOrigins: [\r\n      \"http://localhost:3000\",\r\n      \"http://localhost:4000\",\r\n      \"https://bunplate-web.vercel.app\",\r\n      \"https://bunplate-api.vercel.app\"\r\n    ],\r\n\r\n    database: drizzleAdapter(config.database, {\r\n      provider: \"pg\",\r\n      schema: authSchema,\r\n      usePlural: true\r\n    }),\r\n    secret: config.secret,\r\n    plugins: [admin(), openAPI(), ...(config.plugins || [])],\r\n\r\n    emailAndPassword: {\r\n      enabled: true\r\n    },\r\n\r\n    advanced: {\r\n      cookies: {\r\n        session_token: {\r\n          attributes: {\r\n            sameSite: \"none\",\r\n            secure: true,\r\n            httpOnly: true\r\n          }\r\n        }\r\n      },\r\n      // Enable cross-subdomain cookies for Vercel deployment\r\n      crossSubDomainCookies: isProduction\r\n        ? {\r\n            enabled: true,\r\n            domain: \".vercel.app\" // Share cookies across *.vercel.app subdomains\r\n          }\r\n        : undefined,\r\n      defaultCookieAttributes: {\r\n        sameSite: \"none\", // Use lax for cross-subdomain, none for local dev\r\n        secure: true,\r\n        httpOnly: true,\r\n        partitioned: true // New browser standards will mandate this for foreign cookies\r\n      }\r\n    }\r\n  });\r\n\r\n  return baseAuthInstance;\r\n}\r\n\r\nexport type AuthInstance = ReturnType<typeof configAuth>;\r\n",
    "import { relations } from \"drizzle-orm\";\nimport { pgTable, text, timestamp, boolean, index } from \"drizzle-orm/pg-core\";\n\nexport const users = pgTable(\"users\", {\n  id: text(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull().unique(),\n  emailVerified: boolean(\"email_verified\").default(false).notNull(),\n  image: text(\"image\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\")\n    .defaultNow()\n    .$onUpdate(() => /* @__PURE__ */ new Date())\n    .notNull(),\n  role: text(\"role\"),\n  banned: boolean(\"banned\").default(false),\n  banReason: text(\"ban_reason\"),\n  banExpires: timestamp(\"ban_expires\"),\n});\n\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    id: text(\"id\").primaryKey(),\n    expiresAt: timestamp(\"expires_at\").notNull(),\n    token: text(\"token\").notNull().unique(),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n      .$onUpdate(() => /* @__PURE__ */ new Date())\n      .notNull(),\n    ipAddress: text(\"ip_address\"),\n    userAgent: text(\"user_agent\"),\n    userId: text(\"user_id\")\n      .notNull()\n      .references(() => users.id, { onDelete: \"cascade\" }),\n    impersonatedBy: text(\"impersonated_by\"),\n  },\n  (table) => [index(\"sessions_userId_idx\").on(table.userId)],\n);\n\nexport const accounts = pgTable(\n  \"accounts\",\n  {\n    id: text(\"id\").primaryKey(),\n    accountId: text(\"account_id\").notNull(),\n    providerId: text(\"provider_id\").notNull(),\n    userId: text(\"user_id\")\n      .notNull()\n      .references(() => users.id, { onDelete: \"cascade\" }),\n    accessToken: text(\"access_token\"),\n    refreshToken: text(\"refresh_token\"),\n    idToken: text(\"id_token\"),\n    accessTokenExpiresAt: timestamp(\"access_token_expires_at\"),\n    refreshTokenExpiresAt: timestamp(\"refresh_token_expires_at\"),\n    scope: text(\"scope\"),\n    password: text(\"password\"),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n      .$onUpdate(() => /* @__PURE__ */ new Date())\n      .notNull(),\n  },\n  (table) => [index(\"accounts_userId_idx\").on(table.userId)],\n);\n\nexport const verifications = pgTable(\n  \"verifications\",\n  {\n    id: text(\"id\").primaryKey(),\n    identifier: text(\"identifier\").notNull(),\n    value: text(\"value\").notNull(),\n    expiresAt: timestamp(\"expires_at\").notNull(),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n      .defaultNow()\n      .$onUpdate(() => /* @__PURE__ */ new Date())\n      .notNull(),\n  },\n  (table) => [index(\"verifications_identifier_idx\").on(table.identifier)],\n);\n\nexport const userRelations = relations(users, ({ many }) => ({\n  sessions: many(sessions),\n  accounts: many(accounts),\n}));\n\nexport const sessionRelations = relations(sessions, ({ one }) => ({\n  users: one(users, {\n    fields: [sessions.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const accountRelations = relations(accounts, ({ one }) => ({\n  users: one(users, {\n    fields: [accounts.userId],\n    references: [users.id],\n  }),\n}));\n"
  ],
  "mappings": "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",
  "debugId": "F35D1FF62DF9D1B964756E2164756E21",
  "names": []
}